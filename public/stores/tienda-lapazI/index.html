<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Catalog La Paz</title>
    <!-- Meta tags para identificaci√≥n √∫nica -->
    <meta name="whatsapp-uuid" content="a327e09a-0f45-4327-abb6-13e0f1fab85d">
    <meta name="html-name" content="Tienda la Paz">

   <link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#007bff">

<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="LaPaz">
<link rel="apple-touch-icon" href="/Copilot (1).png">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
       
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: 'Arial', sans-serif;
}

body {
    background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
    padding: 20px;
    transition: all 0.3s;
    color: #f1f1f1;
}

body.modal-open {
    overflow: hidden;
}

h1 {
    text-align: center;
    margin-bottom: 30px;
    font-size: 2.8rem;
    background: linear-gradient(45deg, #00dbde, #fc00ff, #00dbde);
    background-size: 200% auto;
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: gradientText 3s linear infinite;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
}

.search-filter-container {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-bottom: 25px;
    justify-content: center;
}

.search-box {
    flex: 1;
    min-width: 250px;
    max-width: 500px;
    position: relative;
}

.search-box input {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 30px;
    font-size: 16px;
    padding-left: 45px;
    background: rgba(255, 255, 255, 0.1);
    color: white;
    box-shadow: 0 0 15px rgba(0, 219, 222, 0.3);
    transition: all 0.3s;
}

.search-box input:focus {
    outline: none;
    border-color: #00dbde;
    box-shadow: 0 0 20px rgba(0, 219, 222, 0.6);
}

.search-box input::placeholder {
    color: rgba(255, 255, 255, 0.7);
}

.search-box i {
    position: absolute;
    left: 15px;
    top: 50%;
    transform: translateY(-50%);
    color: rgba(255, 255, 255, 0.7);
}

.category-filter {
    flex: 1;
    min-width: 200px;
    max-width: 300px;
    position: relative;
}

.category-filter select {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 30px;
    font-size: 16px;
    background: rgba(255, 255, 255, 0.1);
    color: white;
    box-shadow: 0 0 15px rgba(0, 219, 222, 0.3);
    cursor: pointer;
    transition: all 0.3s;
    appearance: none;
}

.category-filter::after {
    content: '‚ñº';
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    color: rgba(255, 255, 255, 0.7);
    pointer-events: none;
    font-size: 12px;
}

.category-filter select:focus {
    outline: none;
    border-color: #00dbde;
    box-shadow: 0 0 20px rgba(0, 219, 222, 0.6);
}

.catalog {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 25px;
    margin-bottom: 100px;
}

.product-card {
    background: rgba(15, 15, 35, 0.7);
    border-radius: 16px;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
    overflow: hidden;
    transition: transform 0.3s;
    position: relative;
}

.product-card::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    z-index: -1;
    background: linear-gradient(45deg, #00dbde, #fc00ff, #00dbde, #fc00ff);
    background-size: 400% 400%;
    border-radius: 18px;
    animation: borderAnimation 3s ease infinite;
}

.product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
}

.product-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background: linear-gradient(45deg, #ff6b6b, #ff0e0e);
    color: white;
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: bold;
    z-index: 10;
    box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
}

.product-gallery {
    position: relative;
    width: 100%;
    height: 220px;
    background: rgba(0, 0, 0, 0.2);
    overflow: hidden;
}

.gallery-container {
    position: relative;
    width: 100%;
    height: 100%;
}

.gallery-media {
    width: 100%;
    height: 100%;
    object-fit: contain;
    cursor: pointer;
    transition: opacity 0.3s;
}

iframe.gallery-media {
    border: none;
}

.gallery-controls {
    position: absolute;
    bottom: 5px;
    left: 0;
    right: 0;
    display: flex;
    justify-content: center;
    gap: 5px;
    z-index: 5;
    padding: 3px;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(5px);
    border-radius: 15px;
    margin: 0 auto;
    width: fit-content;
    max-width: 90%;
    overflow-x: auto;
}

.gallery-thumbnail {
    width: 30px;
    height: 30px;
    border-radius: 3px;
    object-fit: cover;
    cursor: pointer;
    border: 1px solid rgba(255,255,255,0.3);
    transition: all 0.2s;
    background: rgba(255, 255, 255, 0.2);
    opacity: 0.8;
}

.gallery-thumbnail:hover {
    opacity: 1;
    transform: scale(1.05);
    box-shadow: 0 0 8px rgba(0, 219, 222, 0.7);
}

.gallery-thumbnail.active {
    border-color: #00dbde;
    transform: scale(1.1);
    opacity: 1;
    box-shadow: 0 0 10px rgba(0, 219, 222, 0.9);
}

.gallery-thumbnail.video-thumb {
    position: relative;
}

.gallery-thumbnail.video-thumb::after {
    content: '‚ñ∂';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    text-shadow: 0 0 3px rgba(0,0,0,0.5);
    font-size: 10px;
}

.nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0,0,0,0.6);
    color: white;
    border: none;
    width: 35px;
    height: 35px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 5;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
    font-size: 16px;
    opacity: 0.8;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
}

.nav-btn:hover {
    background: rgba(0,0,0,0.8);
    transform: translateY(-50%) scale(1.1);
    opacity: 1;
    box-shadow: 0 0 15px rgba(0, 219, 222, 0.5);
}

.prev-btn {
    left: 10px;
}

.next-btn {
    right: 10px;
}

.fullscreen-btn {
    position: absolute;
    top: 10px;
    left: 10px;
    background: rgba(0,0,0,0.6);
    color: white;
    border: none;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 5;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
    opacity: 0.8;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
}

.fullscreen-btn:hover {
    background: rgba(0,0,0,0.8);
    transform: scale(1.1);
    opacity: 1;
    box-shadow: 0 0 15px rgba(0, 219, 222, 0.5);
}

.fullscreen-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.95);
    z-index: 2000;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s;
}

.fullscreen-modal.active {
    display: flex;
    opacity: 1;
}

.fullscreen-content {
    max-width: 90%;
    max-height: 90%;
    position: relative;
}

.fullscreen-content img, 
.fullscreen-content iframe {
    max-width: 100%;
    max-height: 90vh;
    display: block;
    margin: 0 auto;
    border-radius: 8px;
    box-shadow: 0 5px 35px rgba(0, 219, 222, 0.4);
}

.close-fullscreen {
    position: absolute;
    top: 20px;
    right: 20px;
    color: white;
    font-size: 30px;
    cursor: pointer;
    background: rgba(0,0,0,0.6);
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
    z-index: 10;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
}

.close-fullscreen:hover {
    background: rgba(255,255,255,0.2);
    transform: rotate(90deg);
    box-shadow: 0 0 20px rgba(0, 219, 222, 0.5);
}

.product-info {
    padding: 18px;
}

.product-name {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 8px;
    color: #ffffff;
}

.product-category {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 5px;
    display: inline-block;
    background: rgba(255, 255, 255, 0.1);
    padding: 3px 8px;
    border-radius: 12px;
    backdrop-filter: blur(5px);
}

.product-price {
    color: #ff6b6b;
    font-weight: bold;
    font-size: 20px;
    margin-bottom: 15px;
    text-shadow: 0 0 8px rgba(255, 107, 107, 0.5);
}

.product-description {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 15px;
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    display: none;
}

.variants {
    margin-bottom: 15px;
    display: none;
}

.variant-title {
    font-size: 14px;
    margin-bottom: 8px;
    color: rgba(255, 255, 255, 0.9);
}

.variant-options {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin-bottom: 15px;
}

.size-option {
    padding: 6px 12px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s;
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

.size-option:hover {
    border-color: #00dbde;
    box-shadow: 0 0 10px rgba(0, 219, 222, 0.5);
}

.size-option.selected {
    background: #00dbde;
    color: white;
    border-color: #00dbde;
    box-shadow: 0 0 15px rgba(0, 219, 222, 0.7);
}

.color-option {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid rgba(255, 255, 255, 0.3);
    transition: all 0.3s;
}

.color-option:hover {
    border-color: #00dbde;
    box-shadow: 0 0 10px rgba(0, 219, 222, 0.5);
    transform: scale(1.1);
}

.color-option.selected {
    border-color: #ffffff;
    transform: scale(1.2);
    box-shadow: 0 0 15px rgba(0, 219, 222, 0.7);
}

.add-to-cart {
    background: linear-gradient(45deg, #00dbde, #fc00ff);
    color: white;
    border: none;
    padding: 12px 15px;
    width: 100%;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s;
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    display: none;
    position: relative;
    overflow: hidden;
    box-shadow: 0 0 15px rgba(0, 219, 222, 0.5);
}

.add-to-cart::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transform: rotate(45deg);
    transition: all 0.5s ease;
}

.add-to-cart:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(0, 219, 222, 0.7);
}

.add-to-cart:hover::before {
    left: 50%;
    top: 50%;
}

.add-to-cart:active {
    transform: scale(0.98);
}

.add-to-cart i {
    font-size: 14px;
}

.view-more-btn {
    background-color: rgba(0, 0, 0, 0.8);
    color: #ffffff;
    border: none;
    padding: 10px 15px;
    width: 100%;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-top: 10px;
    position: relative;
    overflow: hidden;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
}

.view-more-btn::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transform: rotate(45deg);
    transition: all 0.5s ease;
}

.view-more-btn:hover {
    background-color: #000000;
    box-shadow: 0 0 15px rgba(0, 219, 222, 0.5);
}

.view-more-btn:hover::before {
    left: 50%;
    top: 50%;
}

.view-more-btn i {
    transition: transform 0.3s;
}

.view-more-btn.expanded i {
    transform: rotate(180deg);
}

.cart-button {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: linear-gradient(45deg, #00dbde, #fc00ff);
    color: white;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 5px 20px rgba(0, 219, 222, 0.5);
    z-index: 100;
    transition: all 0.3s;
    border: none;
}

.cart-button:hover {
    transform: scale(1.1);
    box-shadow: 0 8px 25px rgba(0, 219, 222, 0.7);
}

.cart-count {
    position: absolute;
    top: -5px;
    right: -5px;
    background-color: #ff6b6b;
    color: white;
    width: 25px;
    height: 25px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
    box-shadow: 0 0 10px rgba(255, 107, 107, 0.7);
}

.cart-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s ease;
    backdrop-filter: blur(5px);
}

.cart-overlay.active {
    display: flex;
    opacity: 1;
}

.cart-container {
    background-color: rgba(15, 15, 35, 0.95);
    width: 90%;
    max-width: 600px;
    max-height: 80vh;
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    transform: translateY(20px);
    transition: transform 0.3s ease;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    overflow: hidden;
    position: relative;
}

.cart-container::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    z-index: -1;
    background: linear-gradient(45deg, #00dbde, #fc00ff, #00dbde, #fc00ff);
    background-size: 400% 400%;
    border-radius: 18px;
    animation: borderAnimation 3s ease infinite;
}

.cart-overlay.active .cart-container {
    transform: translateY(0);
}

.cart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    position: sticky;
    top: 0;
    background: rgba(15, 15, 35, 0.95);
    z-index: 1;
    backdrop-filter: blur(10px);
}

.cart-title {
    font-size: 24px;
    font-weight: bold;
    color: #ffffff;
    margin: 0;
}

.close-cart {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: rgba(255, 255, 255, 0.7);
    transition: all 0.3s;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.close-cart:hover {
    color: #ffffff;
    background: rgba(255, 255, 255, 0.1);
    transform: rotate(90deg);
}

.cart-items {
    overflow-y: auto;
    flex-grow: 1;
    padding: 0 20px;
}

.cart-item {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 15px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s;
}

.cart-item:last-child {
    border-bottom: none;
}

.cart-item:hover {
    background: rgba(255, 255, 255, 0.05);
}

.cart-item-image {
    width: 60px;
    height: 60px;
    object-fit: contain;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 5px;
    flex-shrink: 0;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
}

.item-details {
    flex: 1;
    min-width: 0;
}

.item-name {
    font-weight: bold;
    color: #ffffff;
    margin-bottom: 5px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.item-variants {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.7);
    margin: 3px 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.item-price {
    color: #ff6b6b;
    font-size: 14px;
    font-weight: bold;
    text-shadow: 0 0 5px rgba(255, 107, 107, 0.5);
}

.item-quantity {
    display: flex;
    align-items: center;
    margin-top: 5px;
}

.quantity-input {
    width: 50px;
    text-align: center;
    padding: 5px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 4px;
    margin: 0 5px;
    font-weight: bold;
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

.quantity-btn {
    background-color: rgba(255, 255, 255, 0.1);
    border: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
    font-size: 14px;
    color: white;
}

.quantity-btn:hover {
    background-color: rgba(255, 255, 255, 0.2);
    box-shadow: 0 0 8px rgba(0, 219, 222, 0.5);
}

.remove-item {
    background: none;
    border: none;
    color: #ff6b6b;
    cursor: pointer;
    margin-left: 15px;
    transition: all 0.3s;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    font-size: 14px;
}

.remove-item:hover {
    background: rgba(230, 57, 70, 0.1);
    transform: scale(1.1);
    box-shadow: 0 0 8px rgba(255, 107, 107, 0.5);
}

.cart-total {
    font-size: 20px;
    font-weight: bold;
    text-align: right;
    padding: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.2);
    position: sticky;
    bottom: 70px;
    background: rgba(15, 15, 35, 0.95);
    margin-top: auto;
    color: #ffffff;
    backdrop-filter: blur(10px);
}

.shipping-info {
    display: none;
}

.shipping-info.visible {
    display: block;
}

.cart-actions {
    display: flex;
    justify-content: space-between;
    padding: 15px 20px;
    position: sticky;
    bottom: 0;
    background: rgba(15, 15, 35, 0.95);
    border-top: 1px solid rgba(255, 255, 255, 0.2);
    gap: 15px;
    backdrop-filter: blur(10px);
}

.clear-cart, .send-whatsapp {
    padding: 14px 22px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    flex: 1;
    font-size: 15px;
}

.clear-cart {
    background-color: rgba(255, 255, 255, 0.1);
    color: #ffffff;
}

.clear-cart:hover {
    background-color: rgba(255, 255, 255, 0.2);
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
}

.send-whatsapp {
    background: linear-gradient(45deg, #25D366, #128C7E);
    color: white;
}

.send-whatsapp:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(37, 211, 102, 0.5);
}

.send-whatsapp.disabled {
    background: rgba(255, 255, 255, 0.1);
    cursor: not-allowed;
    opacity: 0.7;
    transform: none;
    box-shadow: none;
}

.empty-cart-message {
    text-align: center;
    color: rgba(255, 255, 255, 0.7);
    padding: 40px 0;
    font-size: 16px;
}

.no-results {
    text-align: center;
    grid-column: 1 / -1;
    padding: 40px;
    color: rgba(255, 255, 255, 0.7);
    font-size: 18px;
}

.error-message {
    text-align: center;
    grid-column: 1 / -1;
    padding: 20px;
    color: #ff6b6b;
    font-size: 16px;
    background-color: rgba(255, 107, 107, 0.1);
    border-radius: 8px;
    margin: 20px;
    border: 1px solid rgba(255, 107, 107, 0.3);
}

.number-selector {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 10px;
}

.number-selector select {
    flex: 1;
    padding: 8px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 5px;
    font-size: 14px;
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

.min-order-message {
    text-align: center;
    color: #ff6b6b;
    font-size: 14px;
    margin: 10px 0;
    padding: 10px;
    background-color: rgba(255, 107, 107, 0.1);
    border-radius: 5px;
    font-weight: bold;
    border: 1px solid rgba(255, 107, 107, 0.3);
}

/* Nuevos estilos para el modal de cliente */
.customer-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 2000;
    opacity: 0;
    transition: opacity 0.3s ease;
    backdrop-filter: blur(5px);
}

.customer-modal.active {
    display: flex;
    opacity: 1;
}

.customer-container {
    background-color: rgba(15, 15, 35, 0.95);
    width: 90%;
    max-width: 500px;
    border-radius: 16px;
    padding: 25px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    transform: translateY(20px);
    transition: transform 0.3s ease;
    position: relative;
}

.customer-container::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    z-index: -1;
    background: linear-gradient(45deg, #00dbde, #fc00ff, #00dbde, #fc00ff);
    background-size: 400% 400%;
    border-radius: 18px;
    animation: borderAnimation 3s ease infinite;
}

.customer-modal.active .customer-container {
    transform: translateY(0);
}

.customer-header {
    margin-bottom: 20px;
    text-align: center;
}

.customer-title {
    font-size: 22px;
    font-weight: bold;
    color: #ffffff;
    margin-bottom: 10px;
}

.customer-instructions {
    color: rgba(255, 255, 255, 0.8);
    font-size: 14px;
}

.customer-form {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.form-group label {
    font-weight: bold;
    font-size: 14px;
    color: rgba(255, 255, 255, 0.9);
}

.form-group input {
    padding: 12px 15px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    font-size: 16px;
    transition: all 0.3s;
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

.form-group input:focus {
    outline: none;
    border-color: #00dbde;
    box-shadow: 0 0 10px rgba(0, 219, 222, 0.5);
}

.customer-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
}

.customer-btn {
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s;
}

.customer-btn.cancel {
    background-color: rgba(255, 255, 255, 0.1);
    color: #ffffff;
}

.customer-btn.cancel:hover {
    background-color: rgba(255, 255, 255, 0.2);
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
}

.customer-btn.submit {
    background: linear-gradient(45deg, #00dbde, #fc00ff);
    color: white;
}

.customer-btn.submit:hover {
    box-shadow: 0 0 15px rgba(0, 219, 222, 0.5);
    transform: translateY(-2px);
}

.form-error {
    color: #ff6b6b;
    font-size: 13px;
    margin-top: 3px;
    display: none;
}

/* Animaciones */
@keyframes borderAnimation {
    0% {
        background-position: 0% 50%;
        opacity: 0.7;
    }
    50% {
        background-position: 100% 50%;
        opacity: 1;
    }
    100% {
        background-position: 0% 50%;
        opacity: 0.7;
    }
}

@keyframes gradientText {
    0% {
        background-position: 0% 50%;
    }
    50% {
        background-position: 100% 50%;
    }
    100% {
        background-position: 0% 50%;
    }
}

@media (max-width: 768px) {
    .catalog {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
    }
    
    .search-filter-container {
        flex-direction: column;
        align-items: stretch;
    }
    
    .search-box, .category-filter {
        max-width: 100%;
    }
    
    .cart-container {
        width: 95%;
    }
    
    .cart-actions {
        flex-direction: column;
    }
    
    .product-gallery {
        height: 250px;
    }
    
    .customer-actions {
        flex-direction: column;
    }
    
    .customer-btn {
        width: 100%;
    }
    
    h1 {
        font-size: 2.2rem;
    }
}

#installBanner {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 3000;
    backdrop-filter: blur(5px);
}

.install-content {
    background: rgba(15, 15, 35, 0.95);
    padding: 30px;
    border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    text-align: center;
    max-width: 400px;
    width: 90%;
    position: relative;
}

.install-content::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    z-index: -1;
    background: linear-gradient(45deg, #00dbde, #fc00ff, #00dbde, #fc00ff);
    background-size: 400% 400%;
    border-radius: 18px;
    animation: borderAnimation 3s ease infinite;
}

.install-content h3 {
    margin-bottom: 15px;
    font-size: 20px;
    color: #ffffff;
}

.install-content button {
    margin: 10px;
    padding: 12px 20px;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.3s;
}

#btnInstall {
    background: linear-gradient(45deg, #00dbde, #fc00ff);
    color: white;
}

#btnInstall:hover {
    box-shadow: 0 0 15px rgba(0, 219, 222, 0.5);
    transform: translateY(-2px);
}

#btnDismiss {
    background-color: rgba(255, 255, 255, 0.1);
    color: #ffffff;
}

#btnDismiss:hover {
    background-color: rgba(255, 255, 255, 0.2);
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
}
    </style>
</head>
<body>
    <h1>Digital Catalog Pro</h1>
    
    <div class="search-filter-container">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Buscar productos..." oninput="filterProducts()">
        </div>
        <div class="category-filter">
            <select id="categoryFilter" onchange="filterProducts()">
                <option value="">Todas las categor√≠as</option>
            </select>
        </div>
    </div>
    
    <div class="catalog" id="catalog">
        <!-- Products will load here -->
        <div class="loading-message">Cargando productos...</div>
    </div>
    
    <div class="fullscreen-modal" id="fullscreenModal">
        <span class="close-fullscreen" id="closeFullscreen">&times;</span>
        <div class="fullscreen-content" id="fullscreenContent"></div>
    </div>
    
    <div class="cart-button" id="cartButton">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-count" id="cartCount">0</span>
    </div>
    
    <div class="cart-overlay" id="cartOverlay">
        <div class="cart-container">
            <div class="cart-header">
                <h2 class="cart-title">Tu carrito</h2>
                <button class="close-cart" id="closeCart"><i class="fas fa-times"></i></button>
            </div>
            <div class="cart-items" id="cartItems">
                <p class="empty-cart-message">Tu carrito est√° vac√≠o</p>
            </div>
            <div class="cart-total">
                Subtotal: <span id="cartSubtotal">Bs 0</span><br>
                <div class="shipping-info" id="shippingInfo">
                    Env√≠o: <span id="cartShipping">Bs 0</span><br>
                </div>
                <strong>Total: <span id="cartTotal">Bs 0</span></strong>
            </div>
            <div class="cart-actions">
                <button class="clear-cart" id="clearCart"><i class="fas fa-trash"></i> Vaciar carrito</button>
                <button class="send-whatsapp" id="sendWhatsApp"><i class="fab fa-whatsapp"></i> Enviar por WhatsApp</button>
            </div>
        </div>
    </div>

<div id="installBanner" style="display: none;">
  <div class="install-content">
    <h3>¬øQuieres agregar esta tienda a tu pantalla principal?</h3>
    <button id="btnInstall">Agregar</button>
    <button id="btnDismiss">Ahora no</button>
  </div>
</div>


    <div id="installBanner" style="display: none;">
  <div class="install-content">
    <h3>¬øQuieres agregar esta tienda a tu pantalla principal?</h3>
    <p>Presiona el √≠cono de compartir <span style="font-size: 20px;">üîó</span> y selecciona "Agregar a pantalla de inicio".</p>
    <button onclick="document.getElementById('installBanner').style.display='none'">Cerrar</button>
  </div>
</div>

    
    <!-- Modal para datos del cliente -->
    <div class="customer-modal" id="customerModal">
        <div class="customer-container">
            <div class="customer-header">
                <h3 class="customer-title">Complete sus datos</h3>
                <p class="customer-instructions">Por favor ingrese su informaci√≥n personal para procesar el pedido</p>
            </div>
            
            <form class="customer-form" id="customerForm">
                <div class="form-group">
                    <label for="customerName">Nombre*</label>
                    <input type="text" id="customerName" placeholder="Ingrese su nombre" required>
                    <div class="form-error" id="nameError">Por favor ingrese su nombre</div>
                </div>
                
                <div class="form-group">
                    <label for="customerLastName">Apellido*</label>
                    <input type="text" id="customerLastName" placeholder="Ingrese su apellido" required>
                    <div class="form-error" id="lastNameError">Por favor ingrese su apellido</div>
                </div>
                
                <div class="form-group">
                    <label for="customerId">N√∫mero de C√©dula*</label>
                    <input type="text" id="customerId" placeholder="Ingrese su c√©dula" required>
                    <div class="form-error" id="idError">Por favor ingrese un n√∫mero de c√©dula v√°lido</div>
                </div>
                
                <div class="customer-actions">
                    <button type="button" class="customer-btn cancel" id="cancelCustomer">Cancelar</button>
                    <button type="submit" class="customer-btn submit">Enviar Pedido</button>
                </div>
            </form>
        </div>
    </div>

    <script>

        
        
        // 1. Configuraci√≥n de Supabase
        const supabaseUrl = 'https://bekzfacymgaytpgfqrzg.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJla3pmYWN5bWdheXRwZ2ZxcnpnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQxMjAzNjcsImV4cCI6MjA2OTY5NjM2N30.R1hbWLGSvp6LcqqsDd-ibTGMS_mrGNl0oP-Ah-0iSt8';
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

        // Variables globales
        let currentExchangeRate = 115.33;
        let shippingCost = 0;
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let products = [];
        let categories = [];
        let whatsappNumber = '584149834667'; // Valor por defecto
        let htmlName = 'Tienda Principal'; // Valor por defecto

        // Obtener configuraci√≥n del HTML
        const whatsappUUID = document.querySelector('meta[name="whatsapp-uuid"]')?.content;
        htmlName = document.querySelector('meta[name="html-name"]')?.content || htmlName;

        // Funci√≥n para obtener configuraci√≥n de WhatsApp
        async function loadWhatsAppNumber() {
            try {
                const whatsappUUID = document.querySelector('meta[name="whatsapp-uuid"]')?.content;
                
                if (!whatsappUUID) throw new Error("No se encontr√≥ el UUID en el HTML");

                const { data, error } = await supabaseClient
                    .from('whatsapp_numbers')
                    .select('phone_number, is_active')
                    .eq('id', whatsappUUID)
                    .eq('is_active', true)
                    .single();

                if (error) throw error;
                if (!data?.phone_number) throw new Error("N√∫mero no encontrado o inactivo");

                whatsappNumber = data.phone_number;
                console.log("UUID usado:", whatsappUUID, "N√∫mero configurado:", whatsappNumber);
                return true;
            } catch (error) {
                console.error("Error al cargar n√∫mero:", error.message);
                alert(`Error: ${error.message}\nVerifica que el UUID ${whatsappUUID} existe y est√° activo en Supabase.`);
                return false;
            }
        }

let deferredPrompt;  //Para agregar a pantalla principal

window.addEventListener("beforeinstallprompt", (e) => {
  e.preventDefault(); // Evita el banner autom√°tico
  deferredPrompt = e;

  document.getElementById("installBanner").style.display = "block";
});

        document.getElementById("btnInstall").addEventListener("click", () => {
  if (!deferredPrompt) return;

  deferredPrompt.prompt();

  deferredPrompt.userChoice.then((choiceResult) => {
    if (choiceResult.outcome === "accepted") {
      console.log("Usuario acept√≥ instalar la app");
    } else {
      console.log("Usuario rechaz√≥ la instalaci√≥n");
    }

    deferredPrompt = null;
    document.getElementById("installBanner").style.display = "none";
  });
});

        document.getElementById("btnDismiss").addEventListener("click", () => {
  document.getElementById("installBanner").style.display = "none";
});


        
        // Funci√≥n para obtener configuraci√≥n de la app
        async function getAppSettings() {
            try {
                const { data, error } = await supabaseClient
                    .from('app_settings')
                    .select('*')
                    .limit(1);

                if (error) throw error;
                if (data && data.length > 0) {
                    currentExchangeRate = parseFloat(data[0].rate) || 115.33;
                    shippingCost = parseFloat(data[0].shipping_cost) || 0;
                }
            } catch (error) {
                console.error("Error al cargar configuraciones:", error);
            }
        }

        // YouTube embed URL converter
        function getYouTubeEmbedUrl(url) {
            if (!url) return '';
            if (url.includes('youtube.com/embed')) return url;
            
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regExp);
            
            return (match && match[2].length === 11) 
                ? `https://www.youtube.com/embed/${match[2]}?autoplay=1&rel=0` 
                : url;
        }
        
        // Funci√≥n para cargar productos
        async function loadProducts() {
            try {
                await getAppSettings();
                
                const { data, error } = await supabaseClient
                    .from('products')
                    .select('*');
                
                if (error) throw error;
                
                if (data && data.length > 0) {
                    return {
                        products: data.map(product => ({
                            id: product.id,
                            name: product.name || 'Unnamed Product',
                            description: product.description || '',
                            price: `Bs ${(parseFloat(product.price?.replace(/[^0-9.]/g, '') || 0) * currentExchangeRate).toFixed(2)}`,
                            originalPrice: product.price || '$0.00',
                            priceValue: parseFloat(product.price?.replace(/[^0-9.]/g, '') || 0),
                            image: product.image || 'https://via.placeholder.com/500',
                            images: product.images || [],
                            video: product.video || '',
                            sizes: product.sizes || [],
                            colors: product.colors || [],
                            badge: product.badge || '',
                            category: product.category || 'Uncategorized'
                        })),
                        categories: [...new Set(data.map(p => p.category))]
                    };
                }
                
                return { products: [], categories: [] };
                
            } catch (error) {
                console.error("Error loading products:", error);
                return { products: [], categories: [] };
            }
        }

        // Display products in catalog
        function displayProducts(productsToShow) {
            const catalogEl = document.getElementById('catalog');
            catalogEl.innerHTML = '';
            
            if (!productsToShow || productsToShow.length === 0) {
                catalogEl.innerHTML = '<div class="no-results">No se encontraron productos que coincidan con tu b√∫squeda</div>';
                return;
            }
            
            productsToShow.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                // Badge (optional)
                const badgeHTML = product.badge 
                    ? `<div class="product-badge">${product.badge}</div>` 
                    : '';
                
                // Prepare media items
                const mediaItems = [];
                if (product.image) mediaItems.push({ type: 'image', src: product.image });
                if (product.images && product.images.length > 0) {
                    product.images.forEach(img => {
                        if (img.trim()) mediaItems.push({ type: 'image', src: img.trim() });
                    });
                }
                if (product.video && product.video.trim()) {
                    mediaItems.push({ type: 'video', src: product.video.trim() });
                }
                
                // Gallery controls
                const galleryControlsHTML = mediaItems.length > 1
                    ? mediaItems.map((media, index) => {
                        const isVideo = media.type === 'video';
                        const thumbSrc = isVideo ? (product.image || media.src) : media.src;
                        return `
                            <img src="${thumbSrc}" 
                                 class="gallery-thumbnail ${index === 0 ? 'active' : ''} ${isVideo ? 'video-thumb' : ''}" 
                                 data-type="${media.type}"
                                 data-src="${media.src}"
                                 data-index="${index}"
                                 onclick="changeMedia(this)">
                        `;
                    }).join('')
                    : '';
                
                // Current media (first by default)
                const currentMedia = mediaItems[0] || { type: 'image', src: product.image };
                let mainMediaHTML = '';
                
                if (currentMedia.type === 'video') {
                    const embedUrl = getYouTubeEmbedUrl(currentMedia.src);
                    mainMediaHTML = `
                        <iframe src="${embedUrl}" 
                                frameborder="0" 
                                allowfullscreen 
                                class="gallery-media"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
                        </iframe>
                        <button class="fullscreen-btn" onclick="openFullscreen('video', '${currentMedia.src}', '${product.description.replace(/'/g, "\\'")}')">
                            <i class="fas fa-expand"></i>
                        </button>
                    `;
                } else {
                    mainMediaHTML = `
                        <img src="${currentMedia.src}" 
                             alt="${product.name}" 
                             class="gallery-media"
                             onclick="openFullscreen('image', '${currentMedia.src}', '${product.description.replace(/'/g, "\\'")}')">
                        <button class="fullscreen-btn" onclick="openFullscreen('image', '${currentMedia.src}', '${product.description.replace(/'/g, "\\'")}')">
                            <i class="fas fa-expand"></i>
                        </button>
                    `;
                }
                
                // Navigation buttons (if multiple media)
                const navButtonsHTML = mediaItems.length > 1
                    ? `
                        <button class="nav-btn prev-btn" onclick="navigateMedia(this.closest('.product-card'), -1)">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="nav-btn next-btn" onclick="navigateMedia(this.closest('.product-card'), 1)">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    `
                    : '';
                
                // Size options
                const sizesHTML = product.sizes && product.sizes.length > 0
                    ? `
                        <div class="variant-title">Talla:</div>
                        <div class="variant-options size-options">
                            ${product.sizes.map((size, i) => `
                                <div class="size-option ${i === 0 ? 'selected' : ''}" 
                                     onclick="selectVariant(this, 'size')">${size.trim()}</div>
                            `).join('')}
                        </div>
                    `
                    : '';
                
                // Color options
                const colorsHTML = product.colors && product.colors.length > 0
                    ? `
                        <div class="variant-title">Color:</div>
                        <div class="variant-options color-options">
                            ${product.colors.map((color, i) => `
                                <div class="color-option ${i === 0 ? 'selected' : ''}" 
                                     style="background: ${color.trim()}" 
                                     onclick="selectVariant(this, 'color')"></div>
                            `).join('')}
                        </div>
                    `
                    : '';
                
                // Build product card HTML
                productCard.innerHTML = `
                    ${badgeHTML}
                    <div class="product-gallery">
                        <div class="gallery-container">
                            ${mainMediaHTML}
                            ${navButtonsHTML}
                        </div>
                        ${galleryControlsHTML ? `
                        <div class="gallery-controls">
                            ${galleryControlsHTML}
                        </div>
                        ` : ''}
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <span class="product-category">${product.category}</span>
                        <div class="product-price">${product.price}</div>
                        <div class="product-description">${product.description}</div>
                        
                        ${sizesHTML || colorsHTML ? `
                        <div class="variants">
                            ${sizesHTML}
                            ${colorsHTML}
                        </div>
                        ` : ''}
                        
                        <button class="add-to-cart" 
                                onclick="addToCart(
                                    '${product.id}', 
                                    '${product.name.replace(/'/g, "\\'")}', 
                                    '${product.price}', 
                                    '${product.image.replace(/'/g, "\\'")}',
                                    this.closest('.product-card')
                                )">
                            <i class="fas fa-cart-plus"></i> Agregar al carrito
                        </button>
                        
                        <button class="view-more-btn" onclick="toggleProductDetails(this)">
                            <i class="fas fa-chevron-down"></i> Ver m√°s
                        </button>
                    </div>
                `;
                
                // Store media items for navigation
                productCard.dataset.mediaItems = JSON.stringify(mediaItems);
                productCard.dataset.currentMediaIndex = '0';
                
                catalogEl.appendChild(productCard);
            });
        }

        // Toggle product details
        function toggleProductDetails(button) {
            const productCard = button.closest('.product-card');
            const description = productCard.querySelector('.product-description');
            const variants = productCard.querySelector('.variants');
            const addToCartBtn = productCard.querySelector('.add-to-cart');
            
            // Toggle classes
            button.classList.toggle('expanded');
            
            // Toggle display
            if (button.classList.contains('expanded')) {
                description.style.display = 'block';
                if (variants) variants.style.display = 'block';
                addToCartBtn.style.display = 'flex';
                button.innerHTML = '<i class="fas fa-chevron-up"></i> Ver menos';
            } else {
                description.style.display = 'none';
                if (variants) variants.style.display = 'none';
                addToCartBtn.style.display = 'none';
                button.innerHTML = '<i class="fas fa-chevron-down"></i> Ver m√°s';
            }
        }

        // Filter products by search and category
        function filterProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const selectedCategory = document.getElementById('categoryFilter').value;
            
            const filteredProducts = products.filter(product => {
                const matchesSearch = product.name.toLowerCase().includes(searchTerm) || 
                                     product.category.toLowerCase().includes(searchTerm) ||
                                     product.description.toLowerCase().includes(searchTerm);
                const matchesCategory = selectedCategory === '' || product.category === selectedCategory;
                return matchesSearch && matchesCategory;
            });
            
            displayProducts(filteredProducts);
        }

        // Change media in gallery
        function changeMedia(element) {
            const mediaType = element.getAttribute('data-type');
            const mediaSrc = element.getAttribute('data-src');
            const index = element.getAttribute('data-index');
            const productCard = element.closest('.product-card');
            const productDescription = productCard.querySelector('.product-description').textContent;
            
            productCard.querySelectorAll('.gallery-thumbnail').forEach(thumb => {
                thumb.classList.remove('active');
            });
            element.classList.add('active');
            
            updateMainMedia(productCard, mediaType, mediaSrc, index, productDescription);
        }

        // Navigate through media items
        function navigateMedia(productCard, direction) {
            const mediaItems = JSON.parse(productCard.dataset.mediaItems || '[]');
            if (mediaItems.length <= 1) return;
            
            let currentIndex = parseInt(productCard.dataset.currentMediaIndex || '0');
            currentIndex += direction;
            
            if (currentIndex < 0) currentIndex = mediaItems.length - 1;
            if (currentIndex >= mediaItems.length) currentIndex = 0;
            
            const media = mediaItems[currentIndex];
            const productDescription = productCard.querySelector('.product-description').textContent;
            updateMainMedia(productCard, media.type, media.src, currentIndex, productDescription);
            
            productCard.querySelectorAll('.gallery-thumbnail').forEach(thumb => {
                thumb.classList.remove('active');
                if (parseInt(thumb.getAttribute('data-index')) === currentIndex) {
                    thumb.classList.add('active');
                }
            });
        }

        // Update main media display
        function updateMainMedia(productCard, mediaType, mediaSrc, index, description) {
            const galleryContainer = productCard.querySelector('.gallery-container');
            const mediaItems = JSON.parse(productCard.dataset.mediaItems || '[]');
            const navButtonsHTML = mediaItems.length > 1
                ? `
                    <button class="nav-btn prev-btn" onclick="navigateMedia(this.closest('.product-card'), -1)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="nav-btn next-btn" onclick="navigateMedia(this.closest('.product-card'), 1)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                `
                : '';
            
            if (mediaType === 'video') {
                const embedUrl = getYouTubeEmbedUrl(mediaSrc);
                galleryContainer.innerHTML = `
                    <iframe src="${embedUrl}" 
                            frameborder="0" 
                            allowfullscreen 
                            class="gallery-media"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
                    </iframe>
                    <button class="fullscreen-btn" onclick="openFullscreen('video', '${mediaSrc}', '${description.replace(/'/g, "\\'")}')">
                        <i class="fas fa-expand"></i>
                    </button>
                    ${navButtonsHTML}
                `;
            } else {
                galleryContainer.innerHTML = `
                    <img src="${mediaSrc}" 
                         class="gallery-media" 
                         onclick="openFullscreen('image', '${mediaSrc}', '${description.replace(/'/g, "\\'")}')">
                    <button class="fullscreen-btn" onclick="openFullscreen('image', '${mediaSrc}', '${description.replace(/'/g, "\\'")}')">
                        <i class="fas fa-expand"></i>
                    </button>
                    ${navButtonsHTML}
                `;
            }
            
            productCard.dataset.currentMediaIndex = index;
        }

        // Open media in fullscreen
        function openFullscreen(type, src, description = '') {
            const fullscreenContent = document.getElementById('fullscreenContent');
            
            if (type === 'video') {
                const embedUrl = getYouTubeEmbedUrl(src);
                fullscreenContent.innerHTML = `
                    <iframe src="${embedUrl}" 
                            frameborder="0" 
                            allowfullscreen
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            class="gallery-media">
                    </iframe>
                    ${description ? `<div class="product-description" style="color: white; margin-top: 15px; max-width: 800px; padding: 0 20px;">${description}</div>` : ''}
                `;
            } else {
                fullscreenContent.innerHTML = `
                    <img src="${src}" class="gallery-media">
                    ${description ? `<div class="product-description" style="color: white; margin-top: 15px; max-width: 800px; padding: 0 20px;">${description}</div>` : ''}
                `;
            }
            
            document.getElementById('fullscreenModal').classList.add('active');
            document.body.classList.add('modal-open');
        }

        // Select variant (size/color)
        function selectVariant(element, type) {
            const container = element.closest(`.${type}-options`);
            container.querySelectorAll(`.${type}-option`).forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
        }

        // Add item to cart
        function addToCart(id, name, price, image, productCard) {
            const selectedSize = productCard.querySelector('.size-option.selected')?.textContent || '';
            const selectedColor = productCard.querySelector('.color-option.selected')?.style.backgroundColor || '';
            
            // Buscar el producto completo para obtener priceValue
            const product = products.find(p => p.id === id);
            const priceValue = product?.priceValue || 0;
            
            const existingItemIndex = cart.findIndex(item => 
                item.id === id && 
                item.size === selectedSize && 
                item.color === selectedColor
            );
            
            if (existingItemIndex !== -1) {
                cart[existingItemIndex].quantity += 1;
            } else {
                cart.push({
                    id,
                    name,
                    price,
                    image,
                    size: selectedSize,
                    color: selectedColor,
                    quantity: 1,
                    priceValue: priceValue
                });
            }
            
            updateCart();
            
            // Feedback animation
            const button = productCard.querySelector('.add-to-cart');
            button.innerHTML = '<i class="fas fa-check"></i> ¬°Agregado!';
            button.style.backgroundColor = '#2e7d32';
            setTimeout(() => {
                button.innerHTML = '<i class="fas fa-cart-plus"></i> Agregar al carrito';
                button.style.backgroundColor = '#4CAF50';
            }, 1000);
        }

        // Update cart display
        function updateCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
            
            const cartItemsEl = document.getElementById('cartItems');
            const cartCount = document.getElementById('cartCount');
            const cartTotal = document.getElementById('cartTotal');
            const cartSubtotal = document.getElementById('cartSubtotal');
            const cartShipping = document.getElementById('cartShipping');
            const shippingInfo = document.getElementById('shippingInfo');
            
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            const emptyMessage = cartItemsEl.querySelector('.empty-cart-message');
            
            if (cart.length === 0) {
                if (!emptyMessage) {
                    const msg = document.createElement('p');
                    msg.className = 'empty-cart-message';
                    msg.textContent = 'Tu carrito est√° vac√≠o';
                    cartItemsEl.appendChild(msg);
                }
            } else if (emptyMessage) {
                emptyMessage.remove();
            }
            
            cartItemsEl.innerHTML = '';
            
            // Mostrar mensaje de m√≠nimo de pedido si es necesario
            if (totalItems > 0 && totalItems < 8) {
                const minOrderMsg = document.createElement('div');
                minOrderMsg.className = 'min-order-message';
                minOrderMsg.innerHTML = `‚ö†Ô∏è M√≠nimo de pedido: 8 productos (actual: ${totalItems})`;
                cartItemsEl.appendChild(minOrderMsg);
            }
            
            cart.forEach((item, index) => {
                const itemEl = document.createElement('div');
                itemEl.className = 'cart-item';
                
                const variantsInfo = [];
                if (item.size) variantsInfo.push(`Talla: ${item.size}`);
                if (item.color) variantsInfo.push(`Color: ${item.color}`);
                
                itemEl.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" class="cart-item-image">
                    <div class="item-details">
                        <div class="item-name">${item.name}</div>
                        ${variantsInfo.length ? `<div class="item-variants">${variantsInfo.join(' ‚Ä¢ ')}</div>` : ''}
                        <div class="item-price">${item.price}</div>
                        <div class="item-quantity">
                            <button class="quantity-btn minus" onclick="decreaseQuantity(${index})">-</button>
                            <input type="number" min="1" value="${item.quantity}" class="quantity-input" 
                                onchange="updateQuantity(${index}, this.value)">
                            <button class="quantity-btn plus" onclick="increaseQuantity(${index})">+</button>
                            <button class="remove-item" onclick="removeItem(${index})"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                `;
                
                cartItemsEl.appendChild(itemEl);
            });
            
            updateTotal();
        }

        // Cart quantity functions
        function increaseQuantity(index) {
            cart[index].quantity += 1;
            updateCart();
        }
        
        function decreaseQuantity(index) {
            if (cart[index].quantity > 1) {
                cart[index].quantity -= 1;
            } else {
                cart.splice(index, 1);
            }
            updateCart();
        }
        
        function updateQuantity(index, newQuantity) {
            newQuantity = parseInt(newQuantity);
            if (isNaN(newQuantity) || newQuantity < 1) {
                newQuantity = 1;
            }
            cart[index].quantity = newQuantity;
            updateCart();
        }
        
        function removeItem(index) {
            cart.splice(index, 1);
            updateCart();
        }

        function updateTotal() {
            const cartSubtotal = document.getElementById('cartSubtotal');
            const cartTotal = document.getElementById('cartTotal');
            const cartShipping = document.getElementById('cartShipping');
            const shippingInfo = document.getElementById('shippingInfo');
            const sendWhatsAppBtn = document.getElementById('sendWhatsApp');
            
            const subtotal = cart.reduce((sum, item) => {
                return sum + (item.priceValue * item.quantity * currentExchangeRate);
            }, 0);
            
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            
            cartSubtotal.textContent = `Bs ${subtotal.toFixed(2)}`;
            
            // Mostrar u ocultar informaci√≥n de env√≠o seg√∫n la cantidad de productos
            if (totalItems >= 8) {
                shippingInfo.classList.add('visible');
                cartShipping.textContent = `Bs ${shippingCost.toFixed(2)}`;
                cartTotal.textContent = `Bs ${(subtotal + shippingCost).toFixed(2)}`;
            } else {
                shippingInfo.classList.remove('visible');
                cartTotal.textContent = `Bs ${subtotal.toFixed(2)}`;
            }
            
            // Actualizar estado del bot√≥n de WhatsApp
            if (totalItems < 8) {
                sendWhatsAppBtn.classList.add('disabled');
                sendWhatsAppBtn.disabled = true;
            } else {
                sendWhatsAppBtn.classList.remove('disabled');
                sendWhatsAppBtn.disabled = false;
            }
        }

        // Clear cart
        function clearCart() {
            if (cart.length === 0) return;
            if (confirm('¬øEst√°s seguro de que deseas vaciar tu carrito?')) {
                cart = [];
                updateCart();
            }
        }

        // Funci√≥n para validar los datos del cliente
        function validateCustomerInfo() {
            const name = document.getElementById('customerName').value.trim();
            const lastName = document.getElementById('customerLastName').value.trim();
            const idNumber = document.getElementById('customerId').value.trim();
            
            // Validar campos
            let isValid = true;
            
            if (!name) {
                document.getElementById('nameError').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('nameError').style.display = 'none';
            }
            
            if (!lastName) {
                document.getElementById('lastNameError').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('lastNameError').style.display = 'none';
            }
            
            if (!idNumber || !/^\d+$/.test(idNumber)) {
                document.getElementById('idError').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('idError').style.display = 'none';
            }
            
            return isValid;
        }
        
        // Funci√≥n para enviar el pedido por WhatsApp con los datos del cliente
        function sendWhatsAppWithCustomerInfo() {
            if (!validateCustomerInfo()) return;
            
            // Verificar nuevamente la cantidad por si cambi√≥ el carrito
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            if (totalItems < 8) {
                alert(`Se requieren al menos 8 productos para realizar el env√≠o. Actualmente tiene ${totalItems} productos.`);
                return;
            }
            
            const name = document.getElementById('customerName').value.trim();
            const lastName = document.getElementById('customerLastName').value.trim();
            const idNumber = document.getElementById('customerId').value.trim();
            
            // Construir mensaje con informaci√≥n del cliente
            let message = `¬°Hola! Me gustar√≠a hacer un pedido:\n\n`;
            message += `*Datos del cliente:*\n`;
            message += `- Nombre completo: ${name} ${lastName}\n`;
            message += `- C√©dula: ${idNumber}\n\n`;
            message += `*Detalles del pedido:*\n\n`;
            
            cart.forEach(item => {
                message += `- ${item.name}`;
                
                const variants = [];
                if (item.size) variants.push(`Talla: ${item.size}`);
                if (item.color) variants.push(`Color: ${item.color}`);
                
                if (variants.length > 0) {
                    message += ` (${variants.join(', ')})`;
                }
                
                const itemTotal = (item.priceValue * item.quantity * currentExchangeRate);
                message += ` x ${item.quantity} = Bs ${itemTotal.toFixed(2)}\n`;
            });
            
            const subtotal = cart.reduce((sum, item) => {
                return sum + (item.priceValue * item.quantity * currentExchangeRate);
            }, 0);
            
            message += `\n*Subtotal:* Bs ${subtotal.toFixed(2)}`;
            
            // Solo incluir env√≠o si se alcanz√≥ el m√≠nimo
            if (totalItems >= 8) {
                message += `\n*Env√≠o:* Bs ${shippingCost.toFixed(2)}`;
                message += `\n*Total:* Bs ${(subtotal + shippingCost).toFixed(2)}\n\n`;
            } else {
                message += `\n*Total:* Bs ${subtotal.toFixed(2)}\n\n`;
            }
            
            message += 'Por favor confirme disponibilidad y tiempo de entrega. ¬°Gracias!';
            
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
            
            // Cerrar modales
            document.getElementById('customerModal').classList.remove('active');
            document.body.classList.remove('modal-open');
            document.getElementById('cartOverlay').classList.remove('active');
            
            // Limpiar formulario
            document.getElementById('customerForm').reset();
            
            // Abrir WhatsApp
            window.open(whatsappUrl, '_blank');
        }
        
        // Funci√≥n modificada para enviar por WhatsApp (ahora muestra el modal primero)
        function sendWhatsApp() {
            if (cart.length === 0) {
                alert('Tu carrito est√° vac√≠o');
                return;
            }
            
            // Calcular cantidad total de productos
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            
            if (totalItems < 8) {
                alert(`Se requieren al menos 8 productos para realizar el env√≠o. Actualmente tiene ${totalItems} productos.`);
                return;
            }
            
            // Mostrar el modal de datos del cliente
            document.getElementById('customerModal').classList.add('active');
            document.body.classList.add('modal-open');
        }

        // Inicializaci√≥n de la aplicaci√≥n
        document.addEventListener('DOMContentLoaded', async function() {
            // Elementos del DOM
            const cartButton = document.getElementById('cartButton');
            const cartOverlay = document.getElementById('cartOverlay');
            const closeCart = document.getElementById('closeCart');
            const clearCartBtn = document.getElementById('clearCart');
            const sendWhatsAppBtn = document.getElementById('sendWhatsApp');
            const fullscreenModal = document.getElementById('fullscreenModal');
            const closeFullscreen = document.getElementById('closeFullscreen');
            const customerModal = document.getElementById('customerModal');
            const customerForm = document.getElementById('customerForm');
            const cancelCustomerBtn = document.getElementById('cancelCustomer');
            
            // Event listeners
            cartButton.addEventListener('click', function() {
                document.body.classList.add('modal-open');
                cartOverlay.classList.add('active');
            });
            
            closeCart.addEventListener('click', function() {
                document.body.classList.remove('modal-open');
                cartOverlay.classList.remove('active');
            });
            
            closeFullscreen.addEventListener('click', function() {
                fullscreenModal.classList.remove('active');
                document.body.classList.remove('modal-open');
            });
            
            fullscreenModal.addEventListener('click', function(e) {
                if (e.target === fullscreenModal) {
                    fullscreenModal.classList.remove('active');
                    document.body.classList.remove('modal-open');
                }
            });
            
            customerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                sendWhatsAppWithCustomerInfo();
            });
            
            cancelCustomerBtn.addEventListener('click', function() {
                customerModal.classList.remove('active');
                document.body.classList.remove('modal-open');
                document.getElementById('customerForm').reset();
                
                // Ocultar mensajes de error
                document.querySelectorAll('.form-error').forEach(el => {
                    el.style.display = 'none';
                });
            });
            
            customerModal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                    document.body.classList.remove('modal-open');
                    document.getElementById('customerForm').reset();
                    
                    // Ocultar mensajes de error
                    document.querySelectorAll('.form-error').forEach(el => {
                        el.style.display = 'none';
                    });
                }
            });
            
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    if (fullscreenModal.classList.contains('active')) {
                        fullscreenModal.classList.remove('active');
                        document.body.classList.remove('modal-open');
                    }
                    if (cartOverlay.classList.contains('active')) {
                        cartOverlay.classList.remove('active');
                        document.body.classList.remove('modal-open');
                    }
                    if (customerModal.classList.contains('active')) {
                        customerModal.classList.remove('active');
                        document.body.classList.remove('modal-open');
                    }
                }
            });
            
            clearCartBtn.addEventListener('click', clearCart);
            sendWhatsAppBtn.addEventListener('click', sendWhatsApp);
            
            // Validaci√≥n en tiempo real para la c√©dula (solo n√∫meros)
            document.getElementById('customerId').addEventListener('input', function() {
                this.value = this.value.replace(/\D/g, '');
            });
            
            // Inicializar la aplicaci√≥n
            async function initApp() {
                try {
                    // Cargar configuraci√≥n de WhatsApp
                    await loadWhatsAppNumber();
                    
                    // Cargar configuraci√≥n de la app
                    await getAppSettings();
                    
                    // Cargar productos
                    const { products: loadedProducts, categories: loadedCategories } = await loadProducts();
                    products = loadedProducts;
                    categories = loadedCategories;
                    
                    if (products.length === 0) {
                        document.getElementById('catalog').innerHTML = `
                            <div class="error-message">
                                <i class="fas fa-info-circle"></i> No se encontraron productos en la base de datos
                            </div>
                        `;
                        return;
                    }
                    
                    // Mostrar productos
                    displayProducts(products);
                    
                    // Llenar filtro de categor√≠as
                    const categoryFilter = document.getElementById('categoryFilter');
                    loadedCategories.forEach(category => {
                        const option = document.createElement('option');
                        option.value = category;
                        option.textContent = category;
                        categoryFilter.appendChild(option);
                    });
                    
                    // Actualizar carrito
                    updateCart();
                    
                } catch (error) {
                    console.error("Initialization error:", error);
                    document.getElementById('catalog').innerHTML = `
                        <div class="error-message">
                            <i class="fas fa-exclamation-triangle"></i> Error al cargar los productos. Por favor intente m√°s tarde.
                        </div>
                    `;
                }
            }
            
            initApp();
        });


        
        // Hacer funciones accesibles globalmente
        window.changeMedia = changeMedia;
        window.navigateMedia = navigateMedia;
        window.openFullscreen = openFullscreen;
        window.selectVariant = selectVariant;
        window.addToCart = addToCart;
        window.increaseQuantity = increaseQuantity;
        window.decreaseQuantity = decreaseQuantity;
        window.updateQuantity = updateQuantity;
        window.removeItem = removeItem;
        window.clearCart = clearCart;
        window.sendWhatsApp = sendWhatsApp;
        window.toggleProductDetails = toggleProductDetails;
        window.filterProducts = filterProducts;

if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js').then(reg => {
      console.log('‚úÖ Service Worker registrado:', reg.scope);

      // Verificar si hay actualizaciones cada vez que se carga
      reg.update();

      // Opcional: mostrar si los datos vienen del cach√©
      navigator.serviceWorker.addEventListener('message', event => {
        if (event.data === 'cache-used') {
          console.log('üì¶ Datos servidos desde cach√©');
        }
        if (event.data === 'supabase-used') {
          console.log('üõ∞Ô∏è Datos obtenidos desde Supabase');
        }
      });
    }).catch(err => {
      console.error('‚ùå Error al registrar el Service Worker:', err);
    });
  }
        
    </script>
</body>
</html>
